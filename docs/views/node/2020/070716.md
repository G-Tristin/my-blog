---
title: node关于路径的api
date: 2020-07-03
tags:
 - node
 - path
categories: 
 - node
---
本篇用于了解一些在node当中会使用到的关于文件以及目录的一些api。熟悉这些api并将它们运用到日常的开发当中。

<!-- more -->

## process.cwd()
该方法返回node.js当前进程的工作目录，有可能会变化，比如添加一个子进程

## process.env.pwd()
该方法返回node.js进程启动时的工作目录，不会发生变化。

## __dirname
node.js全局变量指向当前运行的脚本所在目录

## __filename
node.js全局变量指向当前运行的脚本文件名

## path模块
path模块提供了用于处理文件和目录的很多实用的api

### path.dirname(path)
 - path < string >
 - Returns 返回当前path所在目录
```js {4}
console.log(path.dirname('/docs/views/node/2019'))
// /docs/views/node
console.log(path.dirname('D:\\project\\zhongnuo-pc'))
// 注意在windows环境下，文件的路径分隔符是'\\'。
// D:\project
```
::: warning
path必须是一个字符串，该方法返回的结果基本上是最后一个'/'前面的内容。
:::

#### path.sep
用于获取当前环境的路径分隔符。linux下是`/`，windows下是`\\`。

### path.extname(path)
 - path < string >
 - Returns 返回 path 的扩展名(一般会是文件)，返回的扩展名是从 path 最后一个 '.' 开始到结束。如果path的最后部分没有 '.' 或者第一个 '.' 之前没有任何别的字符那么将会返回 '' 。

 ``` js
 path.extname('index.html');
// Returns: '.html'

path.extname('index.coffee.md');
// Returns: '.md'

path.extname('index.');
// Returns: '.'

path.extname('index');
// Returns: ''

path.extname('.index');
// Returns: ''

path.extname('.index.md');
// Returns: '.md'
```
### path.parse(path)
- path < string >
- Returns < object >
`path.parese()`方法返回一个对象，该对象的属性表示路径的重要元素。返回的对象包含以下属性：
- dir：目录
- root：根目录
- base：基础路径名 
- name：名称
- ext：扩展名

windows环境下：
```js
path.parse('D:\\project\\zhongnuo-pc')
//{ 
//    root: 'D:\\',       
//    dir: 'D:\\project',
//     base: 'zhongnuo-pc',
//    ext: '',
//    name: 'zhongnuo-pc'
//}

path.parse('C:\\path\\dir\\file.txt');
// Returns:
// { root: 'C:\\',
//   dir: 'C:\\path\\dir',
//   base: 'file.txt',
//   ext: '.txt',
//   name: 'file' }
```

### path.join([...path])
- ...path < string > 一系列路径段
- Returns < string >
`path.join()`方法会通过特定平台的平台分隔符把所有的路径段都拼接起来，然后规范化路径。如果没有传入任何路径片段，那么就会返回一个 '.'，代表当前的工作目录。 
```js
path.join('/foo', 'bar', 'baz/asdf', 'quux', '..');
// Returns: '/foo/bar/baz/asdf'

path.join('foo', {}, 'bar');
// Throws 'TypeError: Path must be a string. Received {}'
```

### path.format(pathObject)
- pathObject < object >
    - dir
    - root
    - base 
    - bame
    - ext
- Returns < string >
`path.format()`方法返回的是一个path字符串。该方法和`path.parse()`方法整好相反。当给pathObject提供属性时记住某些属性涵盖了别的一些属性。

- 当提供了`pathObject.dir`属性时，`pathObject.root`属性将会被忽略
- 当提供了`pathObject.base`属性时，`pathObejct.ext`和`pathObject.name`属性将会被忽略

```js
path.format({
    root:'/ignored',
    dir:'/home/user/dir',
    base:'file.txt'
})
// return 'home/user/dir/file.txt'

path.format({
    root:'/',
    base:'file.txt',
    ext:'ignored'
})
// return '/file.txt' 

path.format({
  root: '/',
  name: 'file',
  ext: '.txt'
});
// Returns: '/file.txt'
```

### path.isAbsolute(path)
- path < string >
- Returns < boolean >
`path.isAbsolute()`方法用于确认path是不是一个绝对路径。如果path是一个空字符串那么将会返回false
```
path.isAbsolute('/foo/bar'); // true
path.isAbsolute('/baz/..');  // true
path.isAbsolute('qux/');     // false
path.isAbsolute('.');        // false
```

### path.relative(from, to)
- from < string >
- to < string >
- Returns < string >

`path.relative(from, to)`方法返回基于当前工作文件目录`from`和`to`之间的相对路径。如果`from`和`to`拥有着同样的路径，那么将会返回一个空字符串。
```
path.relative('/data/orandea/test/aaa', '/data/orandea/impl/bbb');
// Returns: '../../impl/bbb'
```

### path.resolve([...paths])
- ...paths < string > 一系列路径或者路径段
- Returns：< string > 

`path.resolve()`方法将一系列路径或者路径片段都解析成一个绝对路径。路径片段参数将会从右到左处理，在随后的每条路径之前都添加一条路径，直到构造出一条绝对路径为止。比如以下路径片段：'/foo', '/bar', 'baz',调用path.resolve('/foo', '/bar', 'baz')方法将会返回`/bar/baz`，因为 'baz' 不是一个绝对路径但是`/bar/baz`是一个绝对路径，所以就停止构建了，不会再拼接上 '/foo' 。

> 如果在处理完所有的给定的路径片段后还是不能生成一个绝对路径，那么当前工作目录将会被拼接上去。
> 除非将目录解析到根目录否者将会对生成的路径进行规范化并删除尾部的斜杠。

传入空字符串将会被忽略，如果没有出入任何的路劲片段参数，`path.resolve()`方法将会返回当前的工作目录。
```js
path.resolve('/foo/bar', './baz');
// Returns: '/foo/bar/baz'

path.resolve('/foo/bar', '/tmp/file/');
// Returns: '/tmp/file'

path.resolve('wwwroot', 'static_files/png/', '../gif/image.gif');
// If the current working directory is /home/myself/node,
// this returns '/home/myself/node/wwwroot/static_files/gif/image.gif'
```
### path.normalize(path)
`path.normalize(path)`方法解析规范化给定的path，解析 '..' 和 '.' 字段。
当找到多了路径分隔符的时候，它们将会被平台特定的路径分隔符单个实例代替( / 在 POSIX平台， / 在Windows平台)。尾分隔符将被保留。

POSIX:
```js
path.normalize('/foo/bar//baz/asdf/quux/..');
// Returns: '/foo/bar/baz/asdf'
```

Windows:
```js
path.normalize('C:\\temp\\\\foo\\bar\\..\\');
// Returns: 'C:\\temp\\foo\\'
```